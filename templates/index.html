<!DOCTYPE HTML>
<html>
<head>
    <title>John Tells All: AWS Queue Realtime Stats</title>
    <link rel="stylesheet" href="http://www.w3schools.com/lib/w3.css">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
    <style>
    #log {font-family: monospace;}
    </style>
    <script type="text/javascript" src="//code.jquery.com/jquery-1.4.2.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>
    <script type="text/javascript" charset="utf-8">
        $(document).ready(function() {
            namespace = '/vote';
            var sio_url = 'http://' + document.domain + ':' + location.port + namespace;
            var socket = io.connect(sio_url);

            function log(label, obj) {
                $('#log').append('<br>' + $('<div/>').text(
                    label + ': ' + JSON.stringify(obj)).html());
            }

            function handleVotes(votes_dict) {
                if (typeof(votes_dict.up_count) === 'undefined') {
                    return;
                }

                var down_count = votes_dict.count - votes_dict.up_count;
                $('#vote-count-up').text( votes_dict.up_count );
                $('#vote-count-down').text( down_count );
            }

            socket.on('connect', function() {
                socket.emit('my event', {data: "I'm connected!"});
            });

            socket.on('votes', function(msg) {
                log('Receive', msg);
                handleVotes(msg);
            });

            $("a.vote").bind("click", function(event) {
                log('Send', ['vote', {value: this.id}]);
                socket.emit('vote', {value: this.id}, handleVotes);
            });
        });
    </script>
</head>
<body>

<div class="w3-container">

<header class="w3-row">
<div class="w3-tag w3-round w3-green" style="padding:3px">
  <div class="w3-tag w3-round w3-green w3-border w3-border-white">
    <h1>Cat Voting Booth</h1>
  </div>
</div>
</header>

<img class="w3-twothird" src="http://placekitten.com/300/300">

<p class="w3-third">

<p>
<span class="w3-tag w3-jumbo w3-padding w3-round-large w3-blue w3-center" id="vote-count-up">--</span>
<span class="w3-tag w3-jumbo w3-padding w3-round-large w3-blue w3-center" id="vote-count-down">--</span>
</p>

<p class="w3-row">
<p><b>Vote:</b></p>
<a class="fa fa-thumbs-up vote w3-btn" id="up"> UP</a>
 - <a class="fa fa-thumbs-down vote w3-btn" id="down"> DOWN</a>
</p>

<span class="w3-row">
<p>
<b>SocketIO Messages</b>
</p>
<div id="log"></div>
</span>

</div>

<p>
<i>No designers were injured in the creation of this webapp.</i>
</p>
<p>
Images are not public domain, see <a href="http://placekitten.com/attribution.html">attribution.
</p>
</body>
</html>
